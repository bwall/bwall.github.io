
<!doctype html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
  <title>@botnet_hunter&#39;s blog</title>
  <script src="https://bwall.github.io//bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="https://bwall.github.io//bower_components/iron-icons/iron-icons.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-drawer-panel/paper-drawer-panel.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-icon-button/paper-icon-button.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-toolbar/paper-toolbar.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-fab/paper-fab.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-item/paper-item.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-menu/paper-menu.html">
  <link rel="import" href="https://bwall.github.io//bower_components/iron-image/iron-image.html">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css">
  <style is="custom-style">
    body {
      font-family: 'Roboto', sans-serif;
    }
    .nav {
      border-right: 1px solid #ccc;
    }
    
    paper-scroll-header-panel {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background-color: var(--paper-grey-200, #eee);
       
      --paper-scroll-header-panel-full-header: {
        background-image: url(https://bwall.github.io//images/tracking.png);
      };
       
      --paper-scroll-header-panel-condensed-header: {
        background-image: url(https://bwall.github.io//images/tracking.png);
      };
    }
    
    paper-toolbar {
       
      height: 256px;
      background-color: transparent;
    }
    .profile{
      width: 100%;
      padding-bottom: 20px;
    }
    .photo{
      margin: 20px;
      display: inline-block;
      height: 64px; width: 64px;
      border-radius: 50%;
    }
    .article{
      border: 1px solid #bebebe;
      padding: 16px;
      margin: 16px;
      border-radius: 5px;
      background-color: #fff;
    }
    .title{
      font-size: 22px;
      padding: 8px 0 16px;
    }
    .description{
      font-size: 16px;
      padding-bottom: 8px;
    }
    .author{
      font-size: 16px;
      padding-left: 20px;
      color: white;
    }
    .design{
      font-size: 14px;
    }
    .copyright{
      font-size: 16px;
    }
    paper-menu a {
      text-decoration: none;
      color: #212121;
    }
  </style>

</head>
<body>
  <paper-drawer-panel id="drawerPanel" responsive-width="1280px">
    <div class="nav scroll" drawer>
    
      <iron-image class="profile" sizing="cover" src="https://bwall.github.io//images/vaultboy.jpg">
    
        
          <iron-image class="photo" sizing="cover" src="https://bwall.github.io//images/bwall.png"></iron-image>
        
          <div class="author">Brian Wallace</div>
      </iron-image>
      <paper-menu>
        <a href="https://bwall.github.io/"><paper-item>
          <iron-icon icon="home"></iron-icon>　<div class="flex">Home</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="https://bwall.github.io//categories/"><paper-item>
          <iron-icon icon="drafts"></iron-icon>　<div class="flex">Categories</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="https://bwall.github.io//tags/"><paper-item>
          <iron-icon icon="loyalty"></iron-icon>　<div class="flex">Tags</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
      </paper-menu>
    </div>

    <paper-scroll-header-panel main condenses header-height="256" condensed-header-height="64">

      <paper-toolbar>

        <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
        <div class="bottom title">@botnet_hunter&#39;s blog</div>
        <div class="flex"></div>
        
        
          <a href="https://twitter.com/botnet_hunter"><paper-icon-button src="https://bwall.github.io//images/twitter-dreamstale71.png"></paper-icon-button></a>
        
        
        
          <a href="https://www.linkedin.com/in/botnethunter"><paper-icon-button src="https://bwall.github.io//images/linkedin-dreamstale45.png"></paper-icon-button></a>
        
        
          <a href="https://github.com/bwall"><paper-icon-button src="https://bwall.github.io//images/github2-dreamstale35.png"></paper-icon-button></a>
        
          <a href="https://bwall.github.io//index.xml"><paper-icon-button src="https://bwall.github.io//images/feed-dreamstale27.png"></paper-icon-button></a>
      
      </paper-toolbar>



<div class="content">


  <div class="article">
    <div class="title"><a href="https://bwall.github.io/markov-chains-keyed-obfuscation/">Using Markov chains as a keyed obfuscation method</a></div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/pocs/">PoCs</a>
        
      </div>
     
    <div class="description">Machine learning methods, simple and complex, can be used in almost all aspects of our digital lives. Interestingly enough, it is rarely observed in the offensive side of information security. When I was thinking about the number of ways an attacker can exfiltrate data past a firewall, I decided to try out an old favorite, Markov chains, in order to build the next generation of &ldquo;book ciphers&rdquo;. Markov Chains as a Keyed Obfuscation Method This is a project that has been sitting in my private git repository for a long while, and after I was recently reminded of it, I&rsquo;ve decided to write it up and do an initial release.</div>
    <div class="tags">
      21 Nov 2015
      
        
          <a href="https://bwall.github.io//tags/network/">#network</a>
        
          <a href="https://bwall.github.io//tags/python/">#python</a>
        
          <a href="https://bwall.github.io//tags/project/">#project</a>
        
          <a href="https://bwall.github.io//tags/markov/">#markov</a>
        
          <a href="https://bwall.github.io//tags/machine-learning/">#machine learning</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://bwall.github.io/libemu-scapy-for-shellcode-on-the-network/">Detecting shellcode over the network with scapy and libemu</a></div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/pocs/">PoCs</a>
        
      </div>
     
    <div class="description">In this blog post, I will describe a method of using libemu along with scapy in order to detect shellcode being sent across the network in unencrypted channels. This method would not be particularly reasonable for large networks without a significant amount of computing power. On the other hand, for semi-automated analysis, or even integration into something like Cuckoo Sandbox, it may be quite useful. While this proof of concept is currently functional, it would take some work on the project&rsquo;s dependencies in order for me to consider the project a success.</div>
    <div class="tags">
      11 Oct 2015
      
        
          <a href="https://bwall.github.io//tags/network/">#network</a>
        
          <a href="https://bwall.github.io//tags/python/">#python</a>
        
          <a href="https://bwall.github.io//tags/project/">#project</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://bwall.github.io/bamfdetect/">Using bamfdetect in your own workflow</a></div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/tools/">Tools</a>
        
      </div>
     
    <div class="description">When hunting botnets, whether they are custom developed or widely available, it can be helpful to statically extract configurations. With this ability, an automated workflow can be developed to identify and track botnets at scale. For this reason, I have developed bamfdetect. bamfdetect bamfdetect is a tool which is designed to identify malware samples and statically extract their configuration information, such as the domain name of the command and control server.</div>
    <div class="tags">
      4 Oct 2015
      
        
          <a href="https://bwall.github.io//tags/botnet/">#botnet</a>
        
          <a href="https://bwall.github.io//tags/python/">#python</a>
        
          <a href="https://bwall.github.io//tags/project/">#project</a>
        
          <a href="https://bwall.github.io//tags/utility/">#utility</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://bwall.github.io/torque-exploit/">TORQUE Exploitation Explained</a></div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/vulnerabilities/">Vulnerabilities</a>
        
      </div>
     
    <div class="description">The purpose of this post is to explain the TORQUE vulnerability I recently created a proof of concept for. Since the proof of concept was just a simple stub, I feel the mechanics behind the exploit should be described as well. Torque To be completely honest, I have never used TORQUE before attempting to exploit it. I was looking for a vague CVE to proof of concept, and this one did not appear to obscure CVE-2014-0749.</div>
    <div class="tags">
      2 Jun 2014
      
        
          <a href="https://bwall.github.io//tags/exploit/">#exploit</a>
        
          <a href="https://bwall.github.io//tags/torque/">#torque</a>
        
          <a href="https://bwall.github.io//tags/stack/">#stack</a>
        
          <a href="https://bwall.github.io//tags/buffer-overflow/">#buffer overflow</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://bwall.github.io/extract-hosts/">Extract Hosts</a></div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/tools/">Tools</a>
        
      </div>
     
    <div class="description">Recently, I have been trying to focus more on creating small but useful utilities. The first of these tools to be posted publicly is Extract Hosts. The purpose of this utility is to search for domain names and IP addresses in the supplied input. The following is information posted to the readme on the project page. You can download the 1.1.0 release of Extract Hosts here. ExtractHosts Extracts hosts (IP/Hostnames) from files.</div>
    <div class="tags">
      18 Apr 2014
      
        
          <a href="https://bwall.github.io//tags/project/">#project</a>
        
          <a href="https://bwall.github.io//tags/utility/">#utility</a>
        
          <a href="https://bwall.github.io//tags/python/">#python</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://bwall.github.io/murdering-dexter/">Murdering Dexter</a></div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/vulnerable-vms/">Vulnerable VMs</a>
        
      </div>
     
    <div class="description">Occasionally, I like to build a vulnerable virtual machine demonstating a recently published vulnerability. One of the reasons I do this is because such a small section of the industry is exposed to botnet panels, and the easiest way to get acquianted is by pwning them. It also gives people an opportunity to legally use my exploits without hunting down the source code for the command and control panels themselves. In this vulnerable virtual machine, you get an opportunity to &ldquo;Murder Dexter&rdquo;, the point of sale malware.</div>
    <div class="tags">
      16 Mar 2014
      
        
          <a href="https://bwall.github.io//tags/botnet/">#botnet</a>
        
          <a href="https://bwall.github.io//tags/vulnerable-vm/">#vulnerable vm</a>
        
          <a href="https://bwall.github.io//tags/dexter/">#dexter</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://bwall.github.io/herpes-net-3.0-sqli/">Herpes Net 3.0 SQLi</a></div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/botnets/">Botnets</a>
        
      </div>
     
    <div class="description">During my talk at RSAC 2014, we announced multiple botnet vulnerabilities which had been discovered. The following vulnerability is one of them. Herpes Net is botnet with a wide range of functions, with everything from opening the CD tray to mining bitcoins (via plugins). With a vulnerability in the command and control panel, we can get information on the botnet operator. When this vulnerability was discovered by myself, I had thought it was a rediscovery of a vulnerability discovered by malware.lu.</div>
    <div class="tags">
      9 Mar 2014
      
        
          <a href="https://bwall.github.io//tags/botnet/">#botnet</a>
        
          <a href="https://bwall.github.io//tags/herpesnet/">#herpesnet</a>
        
          <a href="https://bwall.github.io//tags/exploit/">#exploit</a>
        
          <a href="https://bwall.github.io//tags/vulnerability/">#vulnerability</a>
        
          <a href="https://bwall.github.io//tags/sqli/">#sqli</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://bwall.github.io/rsac-2014-botnet-vulnerabilities/">RSAC 2014 Botnet Vulnerabilities</a></div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/vulnerabilities/">Vulnerabilities</a>
        
      </div>
     
    <div class="description">This year at RSAC 2014, Stuart McClure and myself did a talk titled Hacking Exposed: Art of Deterrence. During this talk, we announced various botnet vulnerabilities which had not been previously disclosed and some that had been. Here I will document some of them. Dexter Dexter, the POS malware was the botnet in the primary focus of the talk. There were 2 exploits released prior to RSAC, with slightly different objectives.</div>
    <div class="tags">
      9 Mar 2014
      
        
          <a href="https://bwall.github.io//tags/botnet/">#botnet</a>
        
          <a href="https://bwall.github.io//tags/herpesnet/">#herpesnet</a>
        
          <a href="https://bwall.github.io//tags/exploit/">#exploit</a>
        
          <a href="https://bwall.github.io//tags/vulnerability/">#vulnerability</a>
        
          <a href="https://bwall.github.io//tags/sqli/">#sqli</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://bwall.github.io/multilocker-backdoor/">MultiLocker Backdoor</a></div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/botnets/">Botnets</a>
        
      </div>
     
    <div class="description">In a recent search through some underground communities, I came across the source code to a version of the MultiLocker panel. With ransomware, the security industry is always looking for a good way to resolve the issue without the ransom being paid. This could potentially be done by gathering information from the botnet&rsquo;s panel. While there are likely other vulnerabilities, this one stood out after a quick grep of the code.</div>
    <div class="tags">
      9 Mar 2014
      
        
          <a href="https://bwall.github.io//tags/botnet/">#botnet</a>
        
          <a href="https://bwall.github.io//tags/multilocker/">#multilocker</a>
        
          <a href="https://bwall.github.io//tags/exploit/">#exploit</a>
        
          <a href="https://bwall.github.io//tags/vulnerability/">#vulnerability</a>
        
          <a href="https://bwall.github.io//tags/backdoor/">#backdoor</a>
        
       
    </div>
  </div>


</div>


<paper-item>
  
    <paper-fab disabled icon="chevron-left"></paper-fab>
  
    <div class="flex"></div>
  
    <paper-fab disabled icon="chevron-right"></paper-fab>
  
</paper-item>


      <paper-item>
        <div class="copyright">© 2015 Copyright Brian Wallace</div>
        <div class="flex"></div>
        <div class="design">Design <a href="http://pdevty.github.io/blog/">pdevty</a></div>
      </paper-item>
    </paper-scroll-header-panel>
  </paper-drawer-panel>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
</body>
</html>
