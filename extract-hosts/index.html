
<!doctype html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
  <title>Extract Hosts</title>
  <script src="https://bwall.github.io//bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="https://bwall.github.io//bower_components/iron-icons/iron-icons.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-drawer-panel/paper-drawer-panel.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-icon-button/paper-icon-button.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-toolbar/paper-toolbar.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-fab/paper-fab.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-item/paper-item.html">
  <link rel="import" href="https://bwall.github.io//bower_components/paper-menu/paper-menu.html">
  <link rel="import" href="https://bwall.github.io//bower_components/iron-image/iron-image.html">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css">
  <style is="custom-style">
    body {
      font-family: 'Roboto', sans-serif;
    }
    .nav {
      border-right: 1px solid #ccc;
    }
    
    paper-scroll-header-panel {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background-color: var(--paper-grey-200, #eee);
       
      --paper-scroll-header-panel-full-header: {
        background-image: url(https://bwall.github.io//images/tracking.png);
      };
       
      --paper-scroll-header-panel-condensed-header: {
        background-image: url(https://bwall.github.io//images/tracking.png);
      };
    }
    
    paper-toolbar {
       
      height: 256px;
      background-color: transparent;
    }
    .profile{
      width: 100%;
      padding-bottom: 20px;
    }
    .photo{
      margin: 20px;
      display: inline-block;
      height: 64px; width: 64px;
      border-radius: 50%;
    }
    .article{
      border: 1px solid #bebebe;
      padding: 16px;
      margin: 16px;
      border-radius: 5px;
      background-color: #fff;
    }
    .title{
      font-size: 22px;
      padding: 8px 0 16px;
    }
    .description{
      font-size: 16px;
      padding-bottom: 8px;
    }
    .author{
      font-size: 16px;
      padding-left: 20px;
      color: white;
    }
    .design{
      font-size: 14px;
    }
    .copyright{
      font-size: 16px;
    }
    paper-menu a {
      text-decoration: none;
      color: #212121;
    }
  </style>

</head>
<body>
  <paper-drawer-panel id="drawerPanel" responsive-width="1280px">
    <div class="nav scroll" drawer>
    
      <iron-image class="profile" sizing="cover" src="https://bwall.github.io//images/vaultboy.jpg">
    
        
          <iron-image class="photo" sizing="cover" src="https://bwall.github.io//images/bwall.png"></iron-image>
        
          <div class="author">Brian Wallace</div>
      </iron-image>
      <paper-menu>
        <a href="https://bwall.github.io/"><paper-item>
          <iron-icon icon="home"></iron-icon>　<div class="flex">Home</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="https://bwall.github.io//categories/"><paper-item>
          <iron-icon icon="drafts"></iron-icon>　<div class="flex">Categories</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="https://bwall.github.io//tags/"><paper-item>
          <iron-icon icon="loyalty"></iron-icon>　<div class="flex">Tags</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
      </paper-menu>
    </div>

    <paper-scroll-header-panel main condenses header-height="256" condensed-header-height="64">

      <paper-toolbar>

        <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
        <div class="bottom title">@botnet_hunter&#39;s blog</div>
        <div class="flex"></div>
        
        
          <a href="https://twitter.com/botnet_hunter"><paper-icon-button src="https://bwall.github.io//images/twitter-dreamstale71.png"></paper-icon-button></a>
        
        
        
          <a href="https://www.linkedin.com/in/botnethunter"><paper-icon-button src="https://bwall.github.io//images/linkedin-dreamstale45.png"></paper-icon-button></a>
        
        
          <a href="https://github.com/bwall"><paper-icon-button src="https://bwall.github.io//images/github2-dreamstale35.png"></paper-icon-button></a>
        
          <a href="https://bwall.github.io//index.xml"><paper-icon-button src="https://bwall.github.io//images/feed-dreamstale27.png"></paper-icon-button></a>
      
      </paper-toolbar>



<div class="content">

  <div class="article">
    <div class="title">Extract Hosts</div>
    
      <div class="categories">
        
          <a href="https://bwall.github.io//categories/tools/">Tools</a>
        
      </div>
     
    <div class="description">

<p>Recently, I have been trying to focus more on creating small but useful utilities.  The first of these tools to be posted publicly is <a href="https://github.com/bwall/ExtractHosts">Extract Hosts</a>.  The purpose of this utility is to search for domain names and IP addresses in the supplied input.  The following is information posted to the readme on the project page.  You can download the 1.1.0 release of Extract Hosts <a href="https://github.com/bwall/ExtractHosts/archive/v1.1.0.zip">here</a>.</p>

<!-- more -->

<h1 id="extracthosts:8154605aecfea6ca754b3151f752e9f0">ExtractHosts</h1>

<p>Extracts hosts (IP/Hostnames) from files.  Hosts can be extracted from text files, PE, etc.  Any file that keeps the
host in plaintext without obscuring it, this should extract it.</p>

<p>The name came about when polling random people on the street about the idea, and they responded, &ldquo;eh?&rdquo;.  With this installed,
all you need to type is &lsquo;eh&rsquo; to start pulling hosts from input.</p>

<h1 id="installation:8154605aecfea6ca754b3151f752e9f0">Installation</h1>

<pre><code>git clone https://github.com/bwall/ExtractHosts.git
cd ExtractHosts
sudo python setup.py install
</code></pre>

<h1 id="examples:8154605aecfea6ca754b3151f752e9f0">Examples</h1>

<p>The following are just some example usages</p>

<h2 id="help:8154605aecfea6ca754b3151f752e9f0">help</h2>

<pre><code>bwall@research:~$ eh -h
usage: /usr/local/bin/eh [-h] [-v] [-r] [-f] [-d] [-T] [path [path ...]]

Identifies and extracts domains and IPs from files

positional arguments:
  path                  Paths to files or directories to scan (if not
                        supplied, stdin is the file being read)

optional arguments:
  -h, --help            show this help message and exit
  -v, --version         show program's version number and exit
  -r, --recursive       Scan paths recursively
  -f, --show-files      Show file names along with results
  -d, --hide-duplicates
                        Hide duplicate results (hides per file when show-files
                        is enabled)
  -s, --strict          Stricter processing of domains
  -T, --test            Run some quick self tests

/usr/local/bin/eh v1.1.0 by Brian Wallace (@botnet_hunter)
</code></pre>

<h2 id="wget:8154605aecfea6ca754b3151f752e9f0">wget</h2>

<pre><code>bwall@research:~$ wget http://bwall.github.io/ -qO- | eh -d
bwall.github.io
twitter.com
gmail.com
github.com
README.md
ajax.googleapis.com
crypto-js.googlecode.com
google-analytics.com
</code></pre>

<h2 id="malware:8154605aecfea6ca754b3151f752e9f0">malware</h2>

<p>The 0686429b86844d9d1a14a159a0263b9bfcea4fd247c77537aa0278c9c5cb4ac3 file is a sample of the POS malware, Dexter, created for demo purposes.</p>

<pre><code>bwall@research:~$ eh 0686429b86844d9d1a14a159a0263b9bfcea4fd247c77537aa0278c9c5cb4ac3
houseofcarders.com
</code></pre>

<h2 id="file-system-recursion:8154605aecfea6ca754b3151f752e9f0">File system recursion</h2>

<pre><code>bwall@research:~$ eh -drf Downloads/PEStudio/
/home/bwall/Downloads/PEStudio/PeStudioFunctionsDeprecated.xml  www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioFunctionsDeprecated.xml  msdn.microsoft.com
/home/bwall/Downloads/PEStudio/PeStudioBlackListFunctions.xml   www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioEvasions.xml www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioIndicators.xml   www.winitor.com
/home/bwall/Downloads/PEStudio/ChangeLog.txt    winitor.com
/home/bwall/Downloads/PEStudio/ChangeLog.txt    www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioThresholds.xml   www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioWhiteListSections.xml    www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioBlackListLibraries.xml   www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioOrdinals.xml www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioVirusTotal.xml   www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioCodePages.xml    www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioCodePages.xml    msdn.microsoft.com
/home/bwall/Downloads/PEStudio/PeStudioWhiteListLibraries.xml   www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioFeatures.xml www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudio.exe 6.0.0.0
/home/bwall/Downloads/PEStudio/PeStudioSettings.xml www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml internetmailru.cdnmail.ru
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml sputnik.mail.ru
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml mail.ru
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml Command.com
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml 127.0.0.1
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml 2.0.0.1
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml www.memtest86.com
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml boxedapp.com
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml PAYPAL.COM
/home/bwall/Downloads/PEStudio/PeStudioBlackListStrings.xml start.spoon.net
/home/bwall/Downloads/PEStudio/PeStudioFunctionsUndocumented.xml    www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioWellKnownResources.xml   www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioFunctionsMapping.xml www.winitor.com
/home/bwall/Downloads/PEStudio/PeParser.dll 776::06
/home/bwall/Downloads/PEStudio/PeParser.dll ::
/home/bwall/Downloads/PEStudio/PeParser.dll 3::
/home/bwall/Downloads/PEStudio/PeStudioTranslations.xml www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioBlackListLanguages.xml   www.winitor.com
/home/bwall/Downloads/PEStudio/PeStudioBlackListLanguages.xml   msdn.microsoft.com
</code></pre>

<h1 id="change-log:8154605aecfea6ca754b3151f752e9f0">Change log</h1>

<h2 id="version-1-1-0:8154605aecfea6ca754b3151f752e9f0">Version 1.1.0</h2>

<ul>
<li>Files are no longer loaded completely into RAM so larger files can be processed (performance increase noticed)</li>
<li>Strict mode added, where domains are only considered if all lower case</li>
</ul>

<h1 id="todo:8154605aecfea6ca754b3151f752e9f0">TODO</h1>

<ul>
<li>IPv6 regex needs to be shorted and heavily tested</li>
<li>Heavier testing</li>
<li>Improve performance</li>
<li>Multiple core processing support</li>
</ul>
</div>
    <div class="tags">
      18 Apr 2014
      
        
          <a href="https://bwall.github.io//tags/project/">#project</a>
        
          <a href="https://bwall.github.io//tags/utility/">#utility</a>
        
          <a href="https://bwall.github.io//tags/python/">#python</a>
        
       
    </div>
    
  </div>

</div>

<paper-item>
  
    <a href="https://bwall.github.io/torque-exploit/"><paper-fab icon="chevron-left"><a></a></paper-fab></a>
  
    <div class="flex"></div>
  
    <a href="https://bwall.github.io/murdering-dexter/"><paper-fab icon="chevron-right"></paper-fab></a>
  
</paper-item>

      <paper-item>
        <div class="copyright">© 2015 Copyright Brian Wallace</div>
        <div class="flex"></div>
        <div class="design">Design <a href="http://pdevty.github.io/blog/">pdevty</a></div>
      </paper-item>
    </paper-scroll-header-panel>
  </paper-drawer-panel>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
</body>
</html>
